# =================================================
# ECHELON AGENT CONFIGURATION
# =================================================
# Copy this file to .env and fill in your values
#
# Quick Start:
#   1. Copy this file: cp .env.example .env
#   2. Add your RPC_URL and private key
#   3. Start oracle sync: npm run start:oracle-sync
#   4. Or use PM2: npm run pm2:start
#   5. Or use Docker: npm run docker:build && npm run docker:run
# =================================================

# =================================================
# AGENT CONFIGURATION
# =================================================

# Agent ID (from AgentRegistry contract)
AGENT_ID=1

# Agent type: FundManager or DexSwap
AGENT_TYPE=FundManager

# Agent wallet private key (NEVER commit this!)
# Must be a registered agent on AgentRegistry
AGENT_PRIVATE_KEY=0x...

# =================================================
# ECHELON CONTRACT ADDRESSES (Sepolia)
# =================================================
# Deployed Dec 29, 2025 (Updated)

# AgentRegistry contract address
REGISTRY_ADDRESS=0xCCf3E485bc5339C651f4fbb8F3c37881c0D0e704

# AgentExecution contract address
EXECUTION_ADDRESS=0x861F841b1c2EB3756E3C00840e04B9393330eDF8

# =================================================
# NETWORK CONFIGURATION
# =================================================

# Ethereum RPC endpoint (Alchemy, Infura, etc.)
RPC_URL=https://eth-sepolia.g.alchemy.com/v2/YOUR_API_KEY

# Chain ID (11155111 for Sepolia)
CHAIN_ID=11155111

# =================================================
# ENVIO INDEXER CONFIGURATION
# =================================================

# Envio GraphQL endpoint
ENVIO_URL=http://localhost:8080/v1/graphql

# Optional: Envio API key (if required)
# ENVIO_API_KEY=your_api_key

# =================================================
# AGENT BEHAVIOR CONFIGURATION
# =================================================

# Polling interval in milliseconds (default: 60000 = 1 minute)
POLLING_INTERVAL_MS=60000

# Log level: debug, info, warn, error (default: info)
LOG_LEVEL=info

# =================================================
# UNISWAP V3 CONFIGURATION (Sepolia)
# =================================================
# These have defaults for Sepolia, only override if needed

# Uniswap V3 SwapRouter02 address
UNISWAP_ROUTER_ADDRESS=0x3bFA4769FB09eefC5a80d6E87c3B9C650f7Ae48E

# Uniswap V3 QuoterV2 address
UNISWAP_QUOTER_ADDRESS=0xEd1f6473345F45b75F8179591dd5bA1888cf2FB3

# WETH token address
WETH_ADDRESS=0xfFf9976782d46CC05630D1f6eBAb18b2324d6B14

# USDC token address (Circle testnet)
USDC_ADDRESS=0x2BfBc55F4A360352Dc89e599D04898F150472cA6

# Slippage tolerance (default: 0.005 = 0.5%)
SLIPPAGE_TOLERANCE=0.005

# =================================================
# PIMLICO BUNDLER CONFIGURATION (ERC-4337)
# =================================================
# Required for Smart Account operations

# Pimlico API key (get from https://dashboard.pimlico.io/apikeys)
PIMLICO_API_KEY=your_pimlico_api_key

# Optional: Custom bundler RPC URL (defaults to Pimlico)
# BUNDLER_RPC_URL=https://api.pimlico.io/v2/11155111/rpc?apikey=...

# =================================================
# ORACLE SYNC SERVICE CONFIGURATION
# =================================================
# The Oracle Sync service bridges Envio indexer data to on-chain oracle.
# It runs continuously, syncing reputation scores every 5 minutes.
#
# Architecture:
#   Envio Indexer --> Oracle Sync --> EnvioReputationOracle (on-chain)
#                                              |
#                                    ReputationGateEnforcer
#                                              |
#                                    MetaMask Permission Check
#
# IMPORTANT: After deployment, you must set the oracle updater:
#   cast send $ENVIO_ORACLE_ADDRESS "setEnvioUpdater(address)" $UPDATER_ADDRESS
# =================================================

# EnvioReputationOracle contract address (Sepolia - Dec 29, 2025)
ENVIO_ORACLE_ADDRESS=0x00EEC585Aa6f948107FCe7B36FD4bB07774B4B3a

# Private key for the oracle updater account
# This account must be set as the oracle updater using setEnvioUpdater()
# (Can reuse AGENT_PRIVATE_KEY if that agent is set as updater)
ORACLE_SYNC_PRIVATE_KEY=0x...

# Sync interval in milliseconds (default: 300000 = 5 minutes)
# For hackathon demo, you can set this lower (e.g., 60000 = 1 minute)
ORACLE_SYNC_INTERVAL_MS=300000

# Maximum agents per batch update transaction (default: 50)
# Lower this if you hit gas limits
ORACLE_SYNC_BATCH_SIZE=50

# =================================================
# SUPABASE DELEGATION FETCHER CONFIGURATION
# =================================================
# Used to receive ERC-7715 delegations from users

# Supabase URL (from project settings)
SUPABASE_URL=https://your-project.supabase.co

# Supabase anon/public key (from project API settings)
SUPABASE_ANON_KEY=your_supabase_anon_key

# Delegation polling interval in milliseconds (default: 10000 = 10 seconds)
DELEGATION_POLL_INTERVAL_MS=10000

# =================================================
# FUND MANAGER REDELEGATION SERVICE CONFIGURATION
# =================================================
# Monitors for new permissions granted to Fund Manager and
# automatically triggers redelegation to specialist agents.
#
# Run with: npm run start:fund-manager-redelegation
# Or PM2:   pm2 start ecosystem.config.cjs --only fund-manager-redelegation
# =================================================

# Fund Manager agent ID (default: 1)
FUND_MANAGER_ID=1

# Private key for the Fund Manager wallet
# Must be the registered Fund Manager agent wallet
PRIVATE_KEY=0x...

# Polling interval for new permissions (default: 10000 = 10 seconds)
POLL_INTERVAL_MS=10000

# Maximum retry attempts for failed operations (default: 3)
MAX_RETRIES=3

# Initial retry delay in milliseconds (default: 1000 = 1 second)
# Uses exponential backoff: delay * 2^(attempt-1)
RETRY_DELAY_MS=1000

# Delegation duration in seconds (default: 604800 = 7 days)
DELEGATION_DURATION=604800

# Health check HTTP server port (default: 3100)
HEALTH_PORT=3100
